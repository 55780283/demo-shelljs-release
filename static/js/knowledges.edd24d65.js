(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["knowledges"],{"260f":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page-container",[a("page-header",{attrs:{title:"知识点列表"}}),a("page-btns-bar",[a("i-button",{staticClass:"btn_margin",attrs:{type:"primary"},on:{click:t.showAddModal}},[t._v("新增")]),t.selected_ids.length>0&&0===t.radio1?a("i-button",{staticClass:"btn_margin",attrs:{type:"error"},on:{click:function(e){return t.changeArchive({ids:t.selected_ids,is_archive:1})}}},[t._v("批量归档")]):t._e(),t.selected_ids.length>0&&0===t.radio1?a("i-button",{staticClass:"btn_margin",attrs:{type:"default"},on:{click:function(e){return t.show_edit_tags_modal("添加标签")}}},[t._v("批量添加标签")]):t._e(),t.selected_ids.length>0&&0===t.radio1?a("i-button",{staticClass:"btn_margin",attrs:{type:"default"},on:{click:function(e){return t.show_edit_tags_modal("删除标签")}}},[t._v("批量删除标签")]):t._e()],1),a("page-search-container",{scopedSlots:t._u([{key:"filters",fn:function(){return[a("RadioGroup",{staticStyle:{"margin-bottom":"10px"},attrs:{size:"large",type:"button"},on:{"on-change":t.radio1Change},model:{value:t.radio1,callback:function(e){t.radio1=e},expression:"radio1"}},[a("Radio",{attrs:{label:0}},[t._v("未归档")]),a("Radio",{attrs:{label:1}},[t._v("已归档")])],1)]},proxy:!0}])},[[a("Input",{staticClass:"searcharea_item",staticStyle:{width:"100px"},attrs:{clearable:"",placeholder:"搜索知识点"},model:{value:t.searchData.name,callback:function(e){t.$set(t.searchData,"name",e)},expression:"searchData.name"}}),a("Input",{staticClass:"searcharea_item",staticStyle:{width:"150px"},attrs:{clearable:"",placeholder:"搜索知识点中文释义"},model:{value:t.searchData.name_cn,callback:function(e){t.$set(t.searchData,"name_cn",e)},expression:"searchData.name_cn"}}),a("Select",{staticClass:"searcharea_item",staticStyle:{width:"240px"},attrs:{multiple:"",placeholder:"搜索标签"},model:{value:t.search_tags,callback:function(e){t.search_tags=e},expression:"search_tags"}},t._l(t.tagOptions,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}),1),a("Button",{staticClass:"searcharea_item",attrs:{type:"primary",shape:"circle",icon:"ios-search"},on:{click:t.toSearch}})]],2),a("page-content",[a("Table",{staticClass:"table",attrs:{loading:t.table_loading,size:"small",stripe:"",border:"",columns:t.columns,data:t.list},on:{"on-selection-change":t.selectChange}}),a("mypage",{attrs:{pageData:t.pageData},on:{pageChange:t.pageChange}}),a("Modal",{attrs:{width:"600px",title:t.updatemodaltitle},model:{value:t.addeditmodal,callback:function(e){t.addeditmodal=e},expression:"addeditmodal"}},[a("pair",[a("span",{staticClass:"required",attrs:{slot:"name"},slot:"name"},[t._v("知识点")]),a("Input",{staticStyle:{width:"300px"},attrs:{slot:"value",type:"textarea"},slot:"value",model:{value:t.detailData.name,callback:function(e){t.$set(t.detailData,"name",e)},expression:"detailData.name"}})],1),a("pair",[a("span",{attrs:{slot:"name"},slot:"name"},[t._v("知识点中文释义")]),a("Input",{staticStyle:{width:"300px"},attrs:{slot:"value",type:"textarea"},slot:"value",model:{value:t.detailData.name_cn,callback:function(e){t.$set(t.detailData,"name_cn",e)},expression:"detailData.name_cn"}})],1),a("pair",[a("span",{attrs:{slot:"name"},slot:"name"},[t._v("标签")]),a("Select",{staticStyle:{width:"300px"},attrs:{slot:"value",multiple:""},slot:"value",model:{value:t.detailData.tag_ids,callback:function(e){t.$set(t.detailData,"tag_ids",e)},expression:"detailData.tag_ids"}},t._l(t.tagOptions,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}),1)],1),a("pair",[a("span",{attrs:{slot:"name"},slot:"name"},[t._v("备注")]),a("Input",{staticStyle:{width:"300px"},attrs:{slot:"value",type:"textarea"},slot:"value",model:{value:t.detailData.note,callback:function(e){t.$set(t.detailData,"note",e)},expression:"detailData.note"}})],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text",size:"large"},on:{click:function(e){t.addeditmodal=!1}}},[t._v("取消")]),a("Button",{attrs:{type:"primary",size:"large"},on:{click:t.updateKnowledgeInfo}},[t._v("确定")])],1)],1),a("Modal",{attrs:{title:t.edit_tags_title},on:{"on-ok":function(e){return t.edit_tags()}},model:{value:t.edit_tags_modal,callback:function(e){t.edit_tags_modal=e},expression:"edit_tags_modal"}},[a("CheckboxGroup",{model:{value:t.selected_tags,callback:function(e){t.selected_tags=e},expression:"selected_tags"}},t._l(t.tagOptions,function(e){return a("Checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.name))])}),1)],1),a("Modal",{attrs:{width:"600px",title:"关联单句"},on:{"on-ok":t.relateSentence},model:{value:t.simple_sentences_modal,callback:function(e){t.simple_sentences_modal=e},expression:"simple_sentences_modal"}},[t.simple_sentences_modal?a("simplesentencestable",{staticStyle:{"margin-bottom":"5px"},attrs:{selection:"multiple"},on:{selectchange:t.selectSentencesChange}}):t._e()],1)],1)],1)},i=[],n=(a("7f7f"),a("ac6a"),a("a358")),l={data:function(){var t=this;return{list:[],radio1:0,table_loading:!1,updatemodaltitle:"",addeditmodal:!1,editId:"",tagOptions:[],selected_ids:[],edit_tags_title:"",search_tags:[],selected_tags:[],edit_tags_modal:!1,simple_sentences_modal:!1,selected_sentences_ids:[],detailData:{name:"",name_cn:"",tag_ids:[],note:""},searchData:{page:1,perpage:"",is_archive:0,name:"",name_cn:"",tag_ids:[]},pageData:{total:0,perPage:1,currentPage:1},columns:[{type:"selection",width:60,align:"center",fixed:"left"},{title:"ID",key:"id",width:80,align:"center"},{title:"知识点",key:"name",width:140,align:"center"},{title:"中文",key:"name_cn",width:140,align:"center"},{title:"标签",width:120,render:function(t,e){var a=[];e.row.tags.forEach(function(t){a.push(t.name)});var s=a.join(",");return t("span",s)}},{title:"关联单句",width:100,key:"use_count"},{title:"编辑者",width:140,align:"center",render:function(e,a){return t.$isNone(a.row.operator)?e("span","-"):a.row.operator.name?e("span","".concat(a.row.operator.name_cn,"(").concat(a.row.operator.name,")")):e("span","".concat(a.row.operator.name_cn))}},{title:"修改时间",key:"created_at",width:160,align:"center"},{title:"备注",align:"center",minWidth:160,render:function(t,e){return e.row?t("span",e.row.note):t("span","-")}},{title:"操作",width:200,fixed:"right",render:function(e,a){return 0===t.radio1?e("div",[t.$makeBtn(e,"text","编辑",t.showEditModal,a.row),t.$makeBtn(e,"text","关联句子",t.showSimpleSentencesModal,a.row.id),t.$makeBtn(e,"text","归档",t.changeArchive,{ids:[a.row.id],is_archive:1})]):e("div",[t.$makeBtn(e,"text","还原",t.changeArchive,{ids:[a.row.id],is_archive:0})])}}]}},methods:{selectChange:function(t){var e=this;this.selected_ids=[],t.forEach(function(t){e.selected_ids.push(t.id)})},show_edit_tags_modal:function(t){this.edit_tags_title=t,this.selected_tags=[],this.edit_tags_modal=!0},showSimpleSentencesModal:function(t){this.editId=t,this.simple_sentences_modal=!0},selectSentencesChange:function(t){var e=this;this.selected_sentences_ids=[],t.forEach(function(t){e.selected_sentences_ids.push(t.id)})},relateSentence:function(){var t=this;n["a"].knowledge_info_relate_sentence({params:{knowledge_info_id:this.editId,sentence_ids:this.selected_sentences_ids},cb:function(e){0===e.code&&(t.getList(),t.$Message.success("关联成功！"))}})},edit_tags:function(){var t=this,e={tag_ids:this.selected_tags,knowledge_info_ids:this.selected_ids};n["a"].edit_knowledge_info_tags({type:"添加标签"===this.edit_tags_title?1:2,params:e,cb:function(e){0===e.code&&(t.getList(),t.selected_ids=[],t.$Message.success("标签修改成功！"))}})},toSearch:function(){this.searchData.page=1,this.pageData.currentPage=1,this.searchData.tag_ids=this.search_tags.join(","),this.getList()},pageChange:function(t){this.searchData.page=t,this.getList()},radio1Change:function(t){this.searchData.is_archive=t,this.pageChange(1)},getList:function(){var t=this;this.table_loading=!0,n["a"].get_knowledge_info_list({params:this.searchData,cb:function(e){0==e.code&&(t.list=e.data.list,t.pageData.total=e.data.total,t.pageData.perPage=e.data.perPage,t.pageData.currentPage=e.data.currentPage,t.table_loading=!1)}})},changeArchive:function(t){var e=this;n["a"].update_knowledge_info_archive({params:t,cb:function(a){0==a.code&&(e.getList(),0==t.is_archive?e.$Message.success("还原成功！"):e.$Message.success("归档成功！"))}})},showAddModal:function(){this.updatemodaltitle="新增知识点",this.$resetObj(this.detailData),this.addeditmodal=!0},showEditModal:function(t){this.updatemodaltitle="编辑知识点",this.detailData.name=t.name,this.detailData.name_cn=t.name_cn,this.detailData.tag_ids=t.tags.map(function(t){return t.id}),this.detailData.note=t.note,this.editId=t.id,this.addeditmodal=!0},updateKnowledgeInfo:function(){var t=this;this.detailData.name?"新增知识点"===this.updatemodaltitle?n["a"].add_knowledge_info({params:this.detailData,cb:function(e){0==e.code&&(t.getList(),t.$Message.success("添加成功！"),t.addeditmodal=!1)}}):n["a"].edit_knowledge_info({id:this.editId,params:this.detailData,cb:function(e){0==e.code&&(t.getList(),t.$Message.success("修改成功！"),t.addeditmodal=!1)}}):this.$Message.warning("请将必填项填写完整！")},getTagOptions:function(){var t=this;n["a"].get_tags_simple_list({type:3,cb:function(e){0===e.code&&(t.tagOptions=e.data)}})}},created:function(){this.getList(),this.getTagOptions()}},o=l,c=a("2877"),d=Object(c["a"])(o,s,i,!1,null,"09534414",null);e["default"]=d.exports}}]);